<div class="container-board pb-1 overflowx">
  <div class="flex gap-4">
    <!-- Open -->
    <div class="list">
      <div
        class="header font-semibold px-5 p-2 text-xl text-gray-400 border border-gray-400 rounded-xl mb-1 mt-3 bg-gray-50"
      >
        Open
      </div>
      <ng-container *ngIf="ticketListOpen.length > 0; else emptyticketListOpen">
        <div class="p-1 rounded-xl border-2 border-gray-400">
          <div class="flex flex-col gap-4 p-2 rounded-lg overflowy">
            <div
              cdkDropList
              #openList="cdkDropList"
              [cdkDropListData]="ticketListOpen"
              class="example-list h-full"
              (cdkDropListDropped)="drop($event)"
              [cdkDropListConnectedTo]="
                roleUser == Role.user
                  ? [canceledList]
                  : roleUser == Role.admin
                  ? [evaluatingList, rejectedList]
                  : []
              "
            >
              <div
                cdkDrag
                class="example-box"
                *ngFor="let item of ticketListOpen"
                [cdkDragDisabled]="
                  roleUser !== Role.user && roleUser !== Role.admin
                "
                [ngClass]="
                  roleUser === Role.user || roleUser === Role.admin
                    ? 'cursor-move'
                    : ''
                "
              >
                <div
                  class="border border-gray-300 bg-gray-50 example-custom-placeholder rounded-lg mb-4"
                  *cdkDragPlaceholder
                ></div>
                <div
                  class="min-w-[354.5px] max-w-[354.5px] p-5 mb-4 bg-white border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600"
                >
                  <div class="flex justify-between">
                    <div class="text-base dark:bg-neutral-500 font-medium mb-4">
                      {{ item.title }}
                    </div>

                    <!-- (click)="navigateTo('path')" -->
                    <button
                      [routerLink]="['tickets/detail', item.id]"
                      type="button"
                      class="ring-2 ring-white h-full py-2 px-3 inline-flex items-start gap-x-2 text-sm font-medium rounded-lg border border-gray-200 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:border-neutral-700 dark:hover:bg-neutral-800 text-gray-900"
                    >
                      View
                    </button>
                  </div>

                  <div class="flex gap-2">
                    <app-badge-priority
                      [badgePriority]="item.priority"
                    ></app-badge-priority>
                    <app-badge-type [type]="item.type"></app-badge-type>
                  </div>

                  <div class="flex flex-row items-center mt-2">
                    <app-badge-user
                      [badgeUser]="item.affectedTo"
                    ></app-badge-user>
                  </div>
                  <p class="text-xs text-gray-500 mt-2">
                    {{ item.createdTime }}
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </ng-container>
    </div>

    <!-- Canceled -->
    <div class="list">
      <div
        class="header font-semibold px-5 p-2 text-xl text-red-500 border border-red-500 rounded-xl mb-1 mt-3 bg-red-50"
      >
        Canceled
      </div>
      <div class="p-1 rounded-xl border-2 border-red-500">
        <div class="flex flex-col gap-4 p-2 rounded-lg overflowy">
          <div
            cdkDropList
            #canceledList="cdkDropList"
            [cdkDropListData]="ticketListCanceled"
            [cdkDropListConnectedTo]="[]"
            class="example-list h-full"
            (cdkDropListDropped)="drop($event)"
          >
            <div
              cdkDrag
              class="example-box"
              cdkDragLockAxis="y"
              *ngFor="let item of ticketListCanceled"
              [cdkDragDisabled]="
                roleUser !== Role.user && roleUser !== Role.admin
              "
              [ngClass]="
                roleUser === Role.user || roleUser === Role.admin
                  ? 'cursor-move'
                  : ''
              "
            >
              <div
                class="border border-red-500 bg-red-50 example-custom-placeholder rounded-lg mb-4"
                *cdkDragPlaceholder
              ></div>
              <div
                class="min-w-[354.5px] max-w-[354.5px] p-5 mb-4 bg-white border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600"
              >
                <div class="flex justify-between">
                  <div class="text-base dark:bg-neutral-500 font-medium mb-4">
                    {{ item.title }}
                  </div>

                  <!-- (click)="navigateTo('path')" -->
                  <button
                    [routerLink]="['tickets/detail', item.id]"
                    type="button"
                    class="ring-2 ring-white h-full py-2 px-3 inline-flex items-start gap-x-2 text-sm font-medium rounded-lg border border-gray-200 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:border-neutral-700 dark:hover:bg-neutral-800 text-gray-900"
                  >
                    View
                  </button>
                </div>

                <div class="flex gap-2">
                  <app-badge-priority
                    [badgePriority]="item.priority"
                  ></app-badge-priority>
                  <app-badge-type [type]="item.type"></app-badge-type>
                </div>

                <div class="flex flex-row items-center mt-2">
                  <app-badge-user
                    [badgeUser]="item.affectedTo"
                  ></app-badge-user>
                </div>
                <p class="text-xs text-gray-500 mt-2">
                  {{ item.createdTime }}
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Evaluating -->
    <div class="list">
      <div
        class="header font-semibold px-5 p-2 text-xl text-gray-800 border border-gray-800 rounded-xl mb-1 mt-3 bg-gray-200"
      >
        Evaluating
      </div>
      <div class="p-1 rounded-xl border-2 border-gray-800">
        <div class="flex flex-col gap-4 p-2 rounded-lg overflowy">
          <div
            cdkDropList
            #evaluatingList="cdkDropList"
            [cdkDropListData]="ticketListEvaluating"
            class="example-list h-full"
            (cdkDropListDropped)="drop($event)"
            [cdkDropListConnectedTo]="
              roleUser == Role.helpDesk
                ? [inProgressList]
                : roleUser == Role.admin
                ? [rejectedList]
                : []
            "
          >
            <div
              cdkDrag
              class="example-box"
              *ngFor="let item of ticketListEvaluating"
              [cdkDragDisabled]="
                roleUser !== Role.admin && roleUser !== Role.helpDesk
              "
              [ngClass]="
                roleUser === Role.admin || roleUser === Role.helpDesk
                  ? 'cursor-move'
                  : ''
              "
            >
              <div
                class="border border-gray-800 bg-gray-200 example-custom-placeholder rounded-lg mb-4"
                *cdkDragPlaceholder
              ></div>
              <div
                class="min-w-[354.5px] max-w-[354.5px] p-5 mb-4 bg-white border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600"
              >
                <div class="flex justify-between">
                  <div class="text-base dark:bg-neutral-500 font-medium mb-4">
                    {{ item.title }}
                  </div>

                  <!-- (click)="navigateTo('path')" -->
                  <button
                    [routerLink]="['tickets/detail', item.id]"
                    type="button"
                    class="ring-2 ring-white h-full py-2 px-3 inline-flex items-start gap-x-2 text-sm font-medium rounded-lg border border-gray-200 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:border-neutral-700 dark:hover:bg-neutral-800 text-gray-900"
                  >
                    View
                  </button>
                </div>

                <div class="flex gap-2">
                  <app-badge-priority
                    [badgePriority]="item.priority"
                  ></app-badge-priority>
                  <app-badge-type [type]="item.type"></app-badge-type>
                </div>

                <div class="flex flex-row items-center mt-2">
                  <app-badge-user
                    [badgeUser]="item.affectedTo"
                  ></app-badge-user>
                </div>
                <p class="text-xs text-gray-500 mt-2">
                  {{ item.createdTime }}
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Rejected -->
    <div class="list">
      <div
        class="header font-semibold px-5 p-2 text-xl text-yellow-600 border border-yellow-500 rounded-xl mb-1 mt-3 bg-yellow-50"
      >
        Rejected
      </div>
      <div class="p-1 rounded-xl border-2 border-yellow-500">
        <div class="flex flex-col gap-4 p-2 rounded-lg overflowy">
          <div
            cdkDropList
            #rejectedList="cdkDropList"
            [cdkDropListData]="ticketListRejected"
            [cdkDropListConnectedTo]="[]"
            class="example-list h-full"
            (cdkDropListDropped)="drop($event)"
          >
            <div
              cdkDrag
              cdkDragLockAxis="y"
              class="example-box"
              *ngFor="let item of ticketListRejected"
              [cdkDragDisabled]="roleUser !== Role.admin"
              [ngClass]="roleUser === Role.admin ? 'cursor-move' : ''"
            >
              <div
                class="border border-yellow-500 bg-yellow-50 example-custom-placeholder rounded-lg mb-4"
                *cdkDragPlaceholder
              ></div>
              <div
                class="min-w-[354.5px] max-w-[354.5px] p-5 mb-4 bg-white border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600"
              >
                <div class="flex justify-between">
                  <div class="text-base dark:bg-neutral-500 font-medium mb-4">
                    {{ item.title }}
                  </div>

                  <!-- (click)="navigateTo('path')" -->
                  <button
                    [routerLink]="['tickets/detail', item.id]"
                    type="button"
                    class="ring-2 ring-white h-full py-2 px-3 inline-flex items-start gap-x-2 text-sm font-medium rounded-lg border border-gray-200 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:border-neutral-700 dark:hover:bg-neutral-800 text-gray-900"
                  >
                    View
                  </button>
                </div>

                <div class="flex gap-2">
                  <app-badge-priority
                    [badgePriority]="item.priority"
                  ></app-badge-priority>
                  <app-badge-type [type]="item.type"></app-badge-type>
                </div>

                <div class="flex flex-row items-center mt-2">
                  <app-badge-user
                    [badgeUser]="item.affectedTo"
                  ></app-badge-user>
                </div>
                <p class="text-xs text-gray-500 mt-2">
                  {{ item.createdTime }}
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- In Progress -->
    <div class="list">
      <div
        class="header font-semibold px-5 p-2 text-xl text-blue-600 border border-blue-600 rounded-xl mb-1 mt-3 bg-blue-50"
      >
        In progress
      </div>
      <div class="p-1 rounded-xl border-2 border-blue-600">
        <div class="flex flex-col gap-4 p-2 rounded-lg overflowy">
          <div
            cdkDropList
            #inProgressList="cdkDropList"
            [cdkDropListData]="ticketListInProgress"
            [cdkDropListConnectedTo]="[testingList]"
            class="example-list h-full"
            (cdkDropListDropped)="drop($event)"
          >
            <div
              cdkDrag
              class="example-box"
              *ngFor="let item of ticketListInProgress"
              [cdkDragDisabled]="
                (roleUser !== Role.helpDesk && roleUser !== Role.admin) ||
                itemList_ids.includes('cdk-drop-list-6')
              "
              [ngClass]="
                roleUser === Role.helpDesk || roleUser === Role.admin
                  ? 'cursor-move'
                  : ''
              "
            >
              <div
                class="border border-blue-600 bg-blue-50 example-custom-placeholder rounded-lg mb-4"
                *cdkDragPlaceholder
              ></div>
              <div
                class="min-w-[354.5px] max-w-[354.5px] p-5 mb-4 bg-white border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600"
              >
                <div class="flex justify-between">
                  <div class="text-base dark:bg-neutral-500 font-medium mb-4">
                    {{ item.title }}
                  </div>

                  <!-- (click)="navigateTo('path')" -->
                  <button
                    [routerLink]="['tickets/detail', item.id]"
                    type="button"
                    class="ring-2 ring-white h-full py-2 px-3 inline-flex items-start gap-x-2 text-sm font-medium rounded-lg border border-gray-200 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:border-neutral-700 dark:hover:bg-neutral-800 text-gray-900"
                  >
                    View
                  </button>
                </div>

                <div class="flex gap-2">
                  <app-badge-priority
                    [badgePriority]="item.priority"
                  ></app-badge-priority>
                  <app-badge-type [type]="item.type"></app-badge-type>
                </div>

                <div class="flex flex-row items-center mt-2">
                  <app-badge-user
                    [badgeUser]="item.affectedTo"
                  ></app-badge-user>
                </div>
                <p class="text-xs text-gray-500 mt-2">
                  {{ item.createdTime }}
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Testing -->
    <div class="list">
      <div
        class="header font-semibold px-5 p-2 text-xl text-purple-500 border border-purple-500 rounded-xl mb-1 mt-3 bg-purple-50"
      >
        Testing
      </div>
      <div class="p-1 rounded-xl border-2 border-purple-500">
        <div class="flex flex-col gap-4 p-2 rounded-lg overflowy">
          <div
            cdkDropList
            #testingList="cdkDropList"
            [cdkDropListData]="ticketListTesting"
            class="example-list h-full"
            (cdkDropListDropped)="drop($event)"
            [cdkDropListConnectedTo]="itemList_ids"
          >
            <div
              cdkDrag
              class="example-box"
              *ngFor="let item of ticketListTesting"
              [cdkDragDisabled]="item.isResolved === undefined"
              (cdkDragMoved)="cdkDragMoved(item)"
              (mouseenter)="mouseEnter(item)"
              [ngClass]="
                roleUser === Role.helpDesk || roleUser === Role.admin
                  ? 'cursor-move'
                  : ''
              "
            >
              <div
                class="border border-gray-300 bg-gray-200 example-custom-placeholder rounded-lg mb-4"
                *cdkDragPlaceholder
              ></div>
              <div
                class="min-w-[354.5px] max-w-[354.5px] p-5 mb-4 bg-white border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600"
              >
                <div class="flex justify-between">
                  <div class="text-base dark:bg-neutral-500 font-medium mb-4">
                    {{ item.title }}
                  </div>

                  <!-- (click)="navigateTo('path')" -->
                  <button
                    [routerLink]="['tickets/detail', item.id]"
                    type="button"
                    class="ring-2 ring-white h-full py-2 px-3 inline-flex items-start gap-x-2 text-sm font-medium rounded-lg border border-gray-200 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:border-neutral-700 dark:hover:bg-neutral-800 text-gray-900"
                  >
                    View
                  </button>
                </div>

                <div class="flex gap-2">
                  <app-badge-priority
                    [badgePriority]="item.priority"
                  ></app-badge-priority>
                  <app-badge-type [type]="item.type"></app-badge-type>
                </div>

                <div class="flex flex-row items-center mt-2">
                  <app-badge-user
                    [badgeUser]="item.affectedTo"
                  ></app-badge-user>
                </div>
                <p class="text-xs text-gray-500 mt-2">
                  {{ item.createdTime }}
                </p>
                <div
                  class="flex justify-between pt-5"
                  *ngIf="roleUser === Role.user"
                >
                  <button
                    (click)="resolvedTicket(item.id!, true)"
                    type="button"
                    class="ring-2 ring-white h-full py-2 px-3 inline-flex items-start gap-x-2 text-sm font-medium rounded-lg text-teal-500 border border-gray-200 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:border-neutral-700 dark:hover:bg-neutral-800"
                  >
                    Resolved
                  </button>
                  <button
                    (click)="resolvedTicket(item.id!, false)"
                    type="button"
                    class="ring-2 ring-white h-full py-2 px-3 inline-flex items-start gap-x-2 text-sm font-medium rounded-lg text-red-500 border border-gray-200 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:border-neutral-700 dark:hover:bg-neutral-800"
                  >
                    Unresolved
                  </button>
                </div>

                <div
                  class="flex justify-end pt-5"
                  *ngIf="
                    roleUser === Role.helpDesk ||
                    (roleUser === Role.admin && item.isResolved !== undefined)
                  "
                >
                  <span
                    class="ring-2 ring-white h-full py-2 px-3 inline-flex items-start gap-x-2 text-sm font-medium rounded-lg border bg-white hover:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:border-neutral-700 dark:hover:bg-neutral-800"
                    [ngClass]="
                      item.isResolved
                        ? 'text-teal-500 border-teal-500'
                        : 'text-red-500 border-red-500'
                    "
                  >
                    {{ item.isResolved ? "Resolved" : "Unresolved" }}
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Resolved -->
    <div class="list">
      <div
        class="header font-semibold px-5 p-2 text-xl text-teal-500 border border-teal-500 rounded-xl mb-1 mt-3 bg-teal-50"
      >
        Resolved
      </div>
      <div class="p-1 rounded-xl border-2 border-teal-500">
        <div class="flex flex-col gap-4 p-2 rounded-lg overflowy">
          <div
            cdkDropList
            #resolvedList="cdkDropList"
            [cdkDropListData]="ticketListResolved"
            [cdkDropListConnectedTo]="[]"
            class="example-list h-full"
            (cdkDropListDropped)="drop($event)"
          >
            <div
              cdkDrag
              cdkDragLockAxis="y"
              class="example-box"
              [cdkDragDisabled]="itemList_ids.includes('cdk-drop-list-4')"
              *ngFor="let item of ticketListResolved"
              [ngClass]="roleUser === Role.admin ? 'cursor-move' : ''"
            >
              <div
                class="border border-gray-300 bg-gray-200 example-custom-placeholder rounded-lg mb-4"
                *cdkDragPlaceholder
              ></div>
              <div
                class="min-w-[354.5px] max-w-[354.5px] p-5 mb-4 bg-white border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600"
              >
                <div class="flex justify-between">
                  <div class="text-base dark:bg-neutral-500 font-medium mb-4">
                    {{ item.title }}
                  </div>

                  <!-- (click)="navigateTo('path')" -->
                  <button
                    [routerLink]="['tickets/detail', item.id]"
                    type="button"
                    class="ring-2 ring-white h-full py-2 px-3 inline-flex items-start gap-x-2 text-sm font-medium rounded-lg border border-gray-200 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:border-neutral-700 dark:hover:bg-neutral-800 text-gray-900"
                  >
                    View
                  </button>
                </div>

                <div class="flex gap-2">
                  <app-badge-priority
                    [badgePriority]="item.priority"
                  ></app-badge-priority>
                  <app-badge-type [type]="item.type"></app-badge-type>
                </div>

                <div class="flex flex-row items-center mt-2">
                  <app-badge-user
                    [badgeUser]="item.affectedTo"
                  ></app-badge-user>
                </div>
                <p class="text-xs text-gray-500 mt-2">
                  {{ item.createdTime }}
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #emptyticketListOpen>
  <div
    (click)="navigateTo('tickets/create-ticket')"
    class="min-w-[354.5px] max-w-[354.5px] mt-4 cursor-pointer border-2 border-dashed border-gray-300 example-custom-placeholder rounded-lg mb-4 flex items-center justify-center font-medium gap-1 hover:bg-gray-100"
  >
    <svg
      class="flex-shrink-0 size-6"
      xmlns="http://www.w3.org/2000/svg"
      width="32"
      height="32"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="2"
      stroke-linecap="round"
      stroke-linejoin="round"
    >
      <path d="M5 12h14" />
      <path d="M12 5v14" />
    </svg>
    Create new ticket
  </div>
</ng-template>
